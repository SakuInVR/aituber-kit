# AITuber自動会話機能拡充 実装予定リスト

## フェーズ1: 沈黙検知と自動会話機能の実装

### 1. 沈黙タイマーの実装

- [x] 沈黙検知用のカスタムフック `useSilenceDetection` の作成
  - [x] 最後の発話からの経過時間をカウント
  - [x] 設定可能な閾値（デフォルト20秒）
  - [x] 沈黙状態の変更を検知するイベント発火

### 2. 自動会話生成システムの基盤実装

- [x] 自動会話用のAPIエンドポイント作成
  - [x] `app/api/autoChat/route.ts` の実装（現状は `app/api/auto-chat-gemini/route.ts` などで管理）
  - [x] プロンプト生成ロジックの実装
  - [x] レスポンス処理の実装

### 3. UI/UX実装

- [x] 配信テーマ入力用のUIコンポーネント作成
  - [x] テーマ入力フォームの実装
  - [x] 現在のテーマ表示コンポーネント
- [x] 自動会話設定パネルの実装
  - [x] 沈黙検知の閾値設定
  - [x] 自動会話のON/OFF切り替え
  - [x] テーマ入力フォームの配置

### 4. 状態管理の実装

- [x] Zustandストアの拡張
  - [x] 自動会話関連の状態管理
  - [x] テーマ情報の永続化
  - [x] 設定値の管理

## フェーズ2: セルフ・コメンタリー機能の実装

### 1. 会話履歴管理システム

- [ ] 会話履歴の保存機能
  - [x] 直近の会話を保持するストアの実装
  - [x] 会話履歴の構造定義
  - [x] 履歴の更新ロジック

### 2. 自己言及機能の実装

- [ ] 自己言及用のプロンプト生成システム
  - [ ] 会話履歴を考慮したプロンプト生成
  - [ ] 自己言及の種類の定義
  - [ ] 自然な自己言及のためのロジック

## フェーズ3: 感情システムの実装

### 1. 感情パラメータの実装

- [ ] 感情状態管理システム
  - [ ] 感情値の定義と初期化
  - [ ] 感情値の更新ロジック
  - [ ] 感情値の永続化

### 2. 感情に基づく会話生成

- [ ] 感情に応じたプロンプト生成
  - [ ] 感情値に基づく会話スタイルの変更
  - [ ] 感情表現の自然な組み込み
  - [ ] 感情の遷移を考慮した会話生成

## 優先順位と実装順序

1. フェーズ1の実装を最優先

   - 沈黙検知システム
   - 基本的な自動会話機能
   - 必要最小限のUI実装

2. フェーズ2の実装

   - 会話履歴管理
   - 自己言及機能

3. フェーズ3の実装
   - 感情システム
   - 感情に基づく会話生成

## 技術的な注意点

- パフォーマンスを考慮した実装
- エラーハンドリングの徹底
- ユーザー体験を損なわない実装
- 既存の機能との整合性確保
- テストの実装と品質確保
